<div class="alert alert-info alert-dismissible" *ngIf="bulkImporing">
   <a href="#" (click)="bulkImportClose()" class="close" data-dismiss="alert" aria-label="close">&times;</a>
   <strong>Your import is processing.</strong> We will notify you when your import is finished.
</div>
<div [ngClass]="bulkErrorCount === 0 ? 'alert alert-success alert-dismissible' : 'alert alert-danger alert-dismissible'"
   *ngIf="bulkImportSuccess">
   <a href="#" (click)="bulkImportSuccessClose()" class="close" data-dismiss="alert" aria-label="close">&times;</a>
   Your import "{{xlFileNameWithoutExt}}" is ready with {{bulkErrorCount}} error. <a href="#"
      (click)="gotoBuklImport(importID)" class="alert-link"> Click here to
      view.</a>.
</div>
<div class="alert alert-danger alert-dismissible" *ngIf="somethingMissingError">
   <a href="#" (click)="somethingMissingErrorClose()" class="close" data-dismiss="alert" aria-label="close">&times;</a>
   The required field is missing in the excel file, please check again.
</div>
<!--/.row-->
<div class="row">
   <!--/.row-->
   <div class="col-lg-12">
      <div class="card">
         <div class="card-header">
            <span class="centerposition" id="id202">
               <!-- <i class="icon-plus"></i>  -->
               Record a new process lesson
            </span>
            <button class="btn btn-primary borderbtn float-right" type="button" (click)="importBulkFileHistory()">
               History <i class="fa fa-history"></i></button>
            <button class="btn btn-primary borderbtn float-right" type="button" (click)="importBulkFile()">Import <i
                  class="fa fa-upload"></i></button>
         </div>
         <div class="card-header">
            <input type="radio" id="project" name="lesson" value="project" [(ngModel)]="lf"
               (change)="togglelessonFlow($event, lf)">
            <label for="project" style="margin-left: 5px;">Project</label>
            <input type="radio" style="margin-left: 20px;" id="Process" name="lesson" value="Process" [(ngModel)]="lf"
               (change)="togglelessonFlow($event, lf)">
            <label for="Process" style="margin-left: 5px;">Process</label><br>
         </div>
         <div class="card-body">
            <form class="form-horizontal" [formGroup]="lessonForm" (ngSubmit)="addLesson(lessonForm)" *ngIf="isProject">
               <div class="col-md-12 mb-4">
                  <!-- Nav tabs -->
                  <tabset>
                     <tab heading="Project Details" [active]="projectTab" [disabled]="projectdTab">
                        <div class="row">
                           <div class="col-sm-6">
                              <div class="form-group row">
                                 <label class="col-md-3 col-form-label" for="text-input">Project Type <span
                                       class="danger">*</span></label>
                                 <div class="col-md-9">
                                    <select class="form-control"
                                       [ngClass]="{'has-error is-invalid': isSubmitted && formControls._projectType.errors }"
                                       formControlName="_projectType" (change)="onselectProjecttype($event)" id="ppt">
                                       <option value="" disabled> Select Type</option>
                                       <option *ngFor="let projectype of projectsAsType" value="{{projectype.ID}}">
                                          {{projectype.Name}}</option>
                                    </select>
                                    <div
                                       *ngIf="lessonForm.controls['_projectType'].invalid && (lessonForm.controls['_projectType'].dirty || lessonForm.controls['_projectType'].touched)"
                                       class="custom-errMsg">
                                       <div *ngIf="lessonForm.controls['_projectType'].errors.required">
                                          Project Type is required.
                                       </div>
                                    </div>
                                 </div>
                              </div>
                           </div>
                           <div class="col-sm-6">
                              <div class="form-group row">
                                 <label class="col-md-3 col-form-label" for="text-input">Project Name <span
                                       class="danger">*</span></label>
                                 <div class="col-md-9">
                                    <tag-input [theme]="'minimal'" [(ngModel)]="_projectName" class=""
                                       [ngClass]="{'has-error is-invalid': isSubmitted && formControls._projectname.errors }"
                                       (onAdd)="onselectProject($event)" (onRemove)="onProjectRemoved($event)"
                                       [maxItems]="1" formControlName="_projectname"
                                       [secondaryPlaceholder]="'Select Project'">
                                       <tag-input-dropdown [showDropdownIfEmpty]="true"
                                          [autocompleteItems]="mappingProjectTypeAndProject" [displayBy]="'Name'"
                                          [identifyBy]="'projectId'">
                                       </tag-input-dropdown>
                                       <i class="cui-magnifying-glass icons font-2xl d-block mt-4 searchIcon"></i>
                                    </tag-input>
                                    <div
                                       *ngIf="lessonForm.controls['_projectname'].invalid && (lessonForm.controls['_projectname'].dirty || lessonForm.controls['_projectname'].touched)"
                                       class="custom-errMsg">
                                       <div *ngIf="lessonForm.controls['_projectname'].errors.required">
                                          Project name is required.
                                       </div>
                                    </div>
                                 </div>
                              </div>
                           </div>
                           <div class="col-sm-6" *ngIf="LPN">
                              <div class="form-group row">
                                 <label class="col-md-3 col-form-label" for="text-input">LPN/PPN</label>
                                 <div class="col-md-9">
                                    <input readonly class="form-control" [(ngModel)]="projectNumber" id="text-input"
                                       formControlName="projectNumber" placeholder="Project Number" type="text">
                                 </div>
                              </div>
                           </div>
                           <div class="col-sm-6" *ngIf="!LPN">
                              <div class="form-group row">
                                 <label class="col-md-3 col-form-label" for="text-input">LPN/PPN</label>
                                 <div class="col-md-9">
                                    <!-- <input class="form-control" [(ngModel)]="projectNumber" id="text-input"
                                       maxlength="8" step=".01" formControlName="projectNumber" placeholder="Project Number"
                                       type="text"> -->
                                    <!-- <input class="form-control" type='number' step='0.01' value='0.00'
                                       ng-pattern="/^[0-9]+(\.[0-9]{1,2})?$/"> -->
                                    <input class="form-control" [(ngModel)]="projectNumber" name="somename" value='0.00'
                                       formControlName="projectNumber" placeholder="Format : 01234.00"
                                       oninput="javascript: if (this.value.length > this.maxLength) this.value = this.value.slice(0, this.maxLength);"
                                       type="number" maxlength="8" />

                                    <div
                                       *ngIf="lessonForm.controls['projectNumber'].invalid && (lessonForm.controls['projectNumber'].dirty || lessonForm.controls['projectNumber'].touched)"
                                       class="custom-errMsg">
                                       <div *ngIf="lessonForm.controls['projectNumber'].errors.required">
                                          Project Number is required
                                       </div>
                                    </div>
                                 </div>
                              </div>
                           </div>
                           <div class="col-sm-6">
                              <div class="form-group row">
                                 <label class="col-md-3 col-form-label" for="text-input">Project Phase <span
                                       class="danger">*</span></label>
                                 <div class="col-md-9">
                                    <!-- <input class="form-control" id="text-input" name="text-input" placeholder="Project phase" type="text">   -->
                                    <!-- <tag-input [(ngModel)]="_projectPahse" [theme]="'minimal'" (onAdd)="onselectProjectPhase($event)" (onRemove)="onProjectPhaseRemoved($event)"  [maxItems]="1" name="_projectPhase"  [secondaryPlaceholder]="'Select Phase'">
                                 <tag-input-dropdown   
                                     [showDropdownIfEmpty]="true"                                             
                                     [autocompleteItems]="projectsPhaseAsObjects"
                                     [displayBy]="'phase'"
                                     [identifyBy]="'phaseId'"                                                
                                     >
                                 </tag-input-dropdown>
                                 </tag-input>      
                                 -->
                                    <select class="form-control"
                                       [ngClass]="{'has-error is-invalid': isSubmitted && formControls._projectPhase.errors }"
                                       formControlName="_projectPhase" id="ppo">
                                       <option value="" [selected]='true'>Select Phase</option>
                                       <option *ngFor="let phase of MappingProjectTypeAndPhase" value="{{phase.ID}}">
                                          {{phase.Name}}</option>
                                    </select>
                                    <div
                                       *ngIf="lessonForm.controls['_projectPhase'].invalid && (lessonForm.controls['_projectPhase'].dirty || lessonForm.controls['_projectPhase'].touched)"
                                       class="custom-errMsg">
                                       <div *ngIf="lessonForm.controls['_projectPhase'].errors.required">
                                          Phase is required.
                                       </div>
                                    </div>
                                 </div>
                              </div>
                           </div>
                           <div class="col-sm-6">
                              <div class="form-group row">
                                 <label class="col-md-3 col-form-label" for="text-input">Milestone <span
                                       class="danger">*</span></label>
                                 <div class="col-md-9">
                                    <!-- <input class="form-control" id="text-input" name="text-input" placeholder="Milestone" type="text"> -->
                                    <!--- <tag-input [(ngModel)]="_projectPahseMilestone" [theme]="'minimal'" [maxItems]="1" name="_projectphasemilestone" (onAdd)="onselectMilestone($event)" (onRemove)="onMilestonRemoved($event)"  [secondaryPlaceholder]="'Select Milestone'">
                                 <tag-input-dropdown   
                                     [showDropdownIfEmpty]="true"                                             
                                     [autocompleteItems]="projectsPhaseMilestoneAsObjects"
                                     [displayBy]="'milestone'"
                                     [identifyBy]="'milestoneId'"                                                
                                     >
                                 </tag-input-dropdown>
                                 </tag-input>                                                
                                 -->
                                    <select class="form-control"
                                       [ngClass]="{'has-error is-invalid': isSubmitted && formControls._projectphasemilestone.errors }"
                                       formControlName="_projectphasemilestone" id="ppm"
                                       (change)="onselectMilestone($event)">
                                       <option value="" [selected]='true'>Select Milestone</option>
                                       <option *ngFor="let milestone of mappingProjectAndMilestone"
                                          value="{{milestone.ID}}">{{milestone.Name}}</option>
                                    </select>
                                    <div
                                       *ngIf="lessonForm.controls['_projectphasemilestone'].invalid && (lessonForm.controls['_projectphasemilestone'].dirty || lessonForm.controls['_projectphasemilestone'].touched)"
                                       class="custom-errMsg">
                                       <div *ngIf="lessonForm.controls['_projectphasemilestone'].errors.required">
                                          Milestone is required.
                                       </div>
                                    </div>
                                    <!-- <select class="form-control" [ngClass]="{'has-error is-invalid': isSubmitted && formControls._projectphasemilestone.errors }" formControlName="_projectphasemilestone" id="ppm" (change)="onselectMilestone($event)">
                                 <option value="">Select Milestone</option> 
                                 <option *ngFor="let milestone of projectsPhaseMilestoneAsObjects" value="{{milestonesAsObjects.ID}}">{{milestonesAsObjects.Name}}</option> 
                                 </select>-->
                                 </div>
                              </div>
                           </div>
                           <div class="col-sm-6">
                              <div class="form-group row">
                                 <label class="col-md-3 col-form-label" foFbest r="text-input">Lifecycle <span
                                       class="danger">*</span></label>
                                 <div class="col-md-9">
                                    <!-- <input class="form-control" id="text-input" name="impectcategory" placeholder="Impact category" type="text"> -->
                                    <select class="form-control"
                                       [ngClass]="{'has-error is-invalid': isSubmitted && formControls.lifecycle.errors }"
                                       [(ngModel)]="lifecycle" formControlName="lifecycle" id="icat">
                                       <option value="" selected>Select Lifecycle</option>
                                       <option *ngFor="let lifecycle of lifecycleAsObjects" value="{{lifecycle.ID}}">
                                          {{lifecycle.Name}}</option>
                                    </select>
                                    <div
                                       *ngIf="lessonForm.controls['lifecycle'].invalid && (lessonForm.controls['lifecycle'].dirty || lessonForm.controls['lifecycle'].touched)"
                                       class="custom-errMsg">
                                       <div *ngIf="lessonForm.controls['lifecycle'].errors.required">
                                          Life Cycle is required.
                                       </div>
                                    </div>
                                 </div>
                              </div>
                           </div>
                           <div class="col-sm-6">
                              <div class="form-group row">
                                 <label class="col-md-3 col-form-label" for="text-input">Function <span
                                       class="danger">*</span></label>
                                 <div class="col-md-9">
                                    <!-- <input class="form-control" id="text-input" name="impectlevel" placeholder="Impact level" type="text"> -->
                                    <!-- <select class="form-control"
                                       [ngClass]="{'has-error is-invalid': isSubmitted && formControls.function.errors }"
                                       formControlName="function" id="function">
                                       <option value="" [selected]='true'>Select Function</option>
                                       <option *ngFor="let function of functionAsObjects" value="{{function.ID}}">
                                          {{function.Name}}</option>
                                    </select> -->
                                    <ng-multiselect-dropdown class="selectdiv cssformultiselect"
                                       [placeholder]="'Select Functions'" [data]="functionAsObjects"
                                       (click)="onClickFunction()" (onSelect)="onFunctionSelect()"
                                       formControlName="function" [(ngModel)]="function" [settings]="dropdownSettings">
                                    </ng-multiselect-dropdown>
                                    <!-- <div>{{lessonForm.controls['function'].invalid}}</div> -->
                                    <div *ngIf="lessonForm.controls['function'].invalid && isClickFunction"
                                       class="custom-errMsg">
                                       <div *ngIf="lessonForm.controls['function'].errors.required">
                                          Function is required.
                                       </div>
                                    </div>
                                 </div>
                              </div>
                           </div>
                           <div class="col-sm-6">
                              <div class="form-group row">
                                 <label class="col-md-3 col-form-label" for="text-input">Department<span
                                       class="danger">*</span></label>
                                 <div class="col-md-9">
                                    <!-- <input class="form-control" id="text-input" name="impectlevel" placeholder="Impact level" type="text"> -->
                                    <!-- <select class="form-control"
                                       [ngClass]="{'has-error is-invalid': isSubmitted && formControls.department.errors }"
                                       formControlName="department" id="department">
                                       <option value="" [selected]='true'>Select Department</option>
                                       <option *ngFor="let department of departmentAsObjects" value="{{department.ID}}">
                                          {{department.Name}}</option>
                                    </select> -->
                                    <ng-multiselect-dropdown class="selectdiv cssformultiselect"
                                       [placeholder]="'Select Departments'" [data]="departmentAsObjects"
                                       formControlName="department" [(ngModel)]="department"
                                       (click)="onClickDepartment()" (onSelect)="onDepartmentSelect()"
                                       [settings]="dropdownSettings">
                                    </ng-multiselect-dropdown>
                                    <div *ngIf="lessonForm.controls['department'].invalid && isClickDepartment"
                                       class="custom-errMsg">
                                       <div *ngIf="lessonForm.controls['department'].errors.required">
                                          Department is required.
                                       </div>
                                    </div>
                                 </div>
                              </div>
                           </div>
                           <div class="form-actions col-sm-12 text-right">
                              <button class="btn btn-primary borderbtn" type="button" (click)="tabChange(2)"
                                 [disabled]="(!formControls._projectType.value || !formControls._projectname.value || !formControls._projectPhase.value || !formControls._projectphasemilestone.value || !formControls.function.value|| !formControls.lifecycle.value || !formControls.department.value)">Next
                                 <i class="fa fa-angle-double-right"></i></button>
                           </div>
                        </div>
                     </tab>
                     <tab heading="Lesson Details" [active]="lessonTab" [disabled]="lessondTab">
                        <div class="row">
                           <div class="col-sm-6">
                              <div class="form-group row">
                                 <label class="col-md-3 col-form-label" for="textarea-input">Title <span
                                       class="danger">*</span></label>
                                 <div class="col-md-9">
                                    <input class="form-control" [(ngModel)]="title"
                                       [ngClass]="{'has-error is-invalid': isSubmitted && formControls.title.errors }"
                                       id="text-input" formControlName="title" placeholder="Title" type="text">

                                    <div
                                       *ngIf="lessonForm.controls['title'].invalid && (lessonForm.controls['title'].dirty || lessonForm.controls['title'].touched)"
                                       class="custom-errMsg">
                                       <div *ngIf="lessonForm.controls['title'].errors.required">
                                          Title is required.
                                       </div>
                                    </div>

                                 </div>
                              </div>
                           </div>
                           <div class="col-sm-6">
                              <div class="form-group row">
                                 <label class="col-md-3 col-form-label" for="inline-radios"
                                    style="white-space: nowrap;">Type of Lesson<span class="danger">*</span> </label>
                                 <div class="col-md-9 col-form-label">
                                    <select class="form-control" [(ngModel)]="typeoflesson"
                                       [ngClass]="{'has-error is-invalid': isSubmitted && formControls.typeoflesson.errors }"
                                       formControlName="typeoflesson" (change)="onselecttypeoflesson($event)"
                                       id="toflesson">
                                       <option value="" selected>Select Type of Lesson</option>
                                       <option *ngFor="let lessontype of lessontypeAsObjects" value="{{lessontype.ID}}">
                                          {{lessontype.Name}}</option>
                                       <!-- <option value="" [selected]='true'>Select Type of Lesson</option>
                                       <option value="1" selected>Issue</option>
                                       <option value="2">Best Practice</option> -->
                                       <!-- <option value="" [selected]='true'>Select Type of Lesson</option>
                                       <option *ngFor="let lessontype of lessontypeAsObjects"
                                          value="{{lessontype.ID}}">{{lessontype.Name}}</option> -->
                                    </select>


                                    <div
                                       *ngIf="lessonForm.controls['typeoflesson'].invalid && (lessonForm.controls['typeoflesson'].dirty || lessonForm.controls['typeoflesson'].touched)"
                                       class="custom-errMsg">
                                       <div *ngIf="lessonForm.controls['typeoflesson'].errors.required">
                                          Type of lesson is required.
                                       </div>
                                    </div>

                                 </div>
                              </div>
                           </div>
                        </div>
                        <div *ngIf="showIssues">
                           <div class="row">
                              <div class="col-sm-6">
                                 <div class="form-group row">
                                    <label class="col-md-3 col-form-label" for="textarea-input">Description <span
                                          class="danger">*</span></label>
                                    <div class="col-md-9">
                                       <textarea class="form-control" (blur)="lessonFormFields()" id="textarea-input"
                                          [(ngModel)]="issuedescription"
                                          [ngClass]="{'has-error is-invalid': isSubmitted && formControls.issuedescription.errors }"
                                          formControlName="issuedescription" placeholder="Description"
                                          [maxlength]="maxChars" rows="6" #description></textarea>
                                       <label
                                          class="float-left remaning">{{description.value.length}}/{{maxChars}}</label>
                                       <div
                                          *ngIf="lessonForm.controls['issuedescription'].invalid && (lessonForm.controls['issuedescription'].dirty || lessonForm.controls['issuedescription'].touched)"
                                          class="custom-errMsg float-right">
                                          <div *ngIf="lessonForm.controls['issuedescription'].errors.required">
                                             Description is required.
                                          </div>
                                          <div *ngIf="lessonForm.controls['issuedescription'].errors.maxlength">
                                             Maximum character is 250 !!!
                                          </div>
                                       </div>
                                    </div>
                                 </div>
                              </div>
                              <div class="col-sm-6">
                                 <div class="form-group row">
                                    <label class="col-md-3 col-form-label" for="textarea-input">Root Cause <span
                                          class="danger">*</span></label>
                                    <div class="col-md-9">
                                       <textarea class="form-control" (blur)="lessonFormFields()" id="textarea-input"
                                          [ngClass]="{'has-error is-invalid': isSubmitted && formControls.rootcause.errors }"
                                          [(ngModel)]="rootcause" formControlName="rootcause"
                                          placeholder="Root cause..." rows="6" maxlength="250" #root></textarea>
                                       <label class="float-left remaning">{{root.value.length}}/{{maxChars}}</label>

                                       <div
                                          *ngIf="lessonForm.controls['rootcause'].invalid && (lessonForm.controls['rootcause'].dirty || lessonForm.controls['rootcause'].touched)"
                                          class="custom-errMsg">
                                          <div *ngIf="lessonForm.controls['rootcause'].errors.required">
                                             Root cause is required.
                                          </div>
                                       </div>

                                    </div>
                                 </div>
                              </div>
                              <div class="col-sm-6">
                                 <div class="form-group row">
                                    <label class="col-md-3 col-form-label" for="textarea-input">Recommendation <span
                                          class="danger">*</span></label>
                                    <div class="col-md-9">
                                       <textarea class="form-control" (blur)="lessonFormFields()" id="textarea-input"
                                          [(ngModel)]="Recommendation"
                                          [ngClass]="{'has-error is-invalid': isSubmitted && formControls.Recommendation.errors }"
                                          formControlName="Recommendation" placeholder="Recommendation..." rows="6"
                                          maxlength="250" #recommendation></textarea>
                                       <label
                                          class="float-left remaning">{{recommendation.value.length}}/{{maxChars}}</label>

                                       <div
                                          *ngIf="lessonForm.controls['Recommendation'].invalid && (lessonForm.controls['Recommendation'].dirty || lessonForm.controls['Recommendation'].touched)"
                                          class="custom-errMsg">
                                          <div *ngIf="lessonForm.controls['Recommendation'].errors.required">
                                             Recommendation is required.
                                          </div>
                                       </div>
                                    </div>
                                 </div>
                              </div>
                              <!-- <div class="col-sm-6">
                                 <div class="form-group row">
                                    <label class="col-md-3 col-form-label" for="text-input">Keywords <span
                                          class="danger">*</span></label>
                                    <div class="col-md-9">
                                       <tag-input [(ngModel)]="_Keywords" [separatorKeyCodes]="[186,59]"
                                          [theme]="'minimal'"
                                          [ngClass]="{'has-error is-invalid': isSubmitted && formControls._Keywords.errors }"
                                          (onAdd)="onselectKeywords($event)" (onRemove)="onKeywordsRemoved($event)"
                                          [maxItems]="5" formControlName="_Keywords"
                                          [secondaryPlaceholder]="'Select Keywords'">
                                          <tag-input-dropdown [autocompleteItems]="keywordsAsObjects"
                                             [displayBy]="'Name'" [identifyBy]="'keywordId'">
                                          </tag-input-dropdown>
                                       </tag-input>
                                       <div
                                          *ngIf="lessonForm.controls['_Keywords'].invalid && (lessonForm.controls['_Keywords'].dirty || lessonForm.controls['_Keywords'].touched)"
                                          class="custom-errMsg">
                                          <div *ngIf="lessonForm.controls['_Keywords'].errors.required">
                                             Keywords are required.
                                          </div>
                                       </div>
                                    </div>
                                 </div>
                              </div> -->
                              <div class="col-sm-6">
                                 <div class="form-group row">
                                    <label class="col-md-3 col-form-label" for="text-input">Keywords<span
                                          class="danger">*</span></label>
                                    <div class="col-md-9">
                                       <tag-input [ngModel]="_Keywords.value" [theme]="'minimal'"
                                          [separatorKeyCodes]="[186,59]" formControlName="_Keywords"
                                          [placeholder]="'Select Keywords'" [secondaryPlaceholder]="'Select Keywords'"
                                          (onAdd)="addIgnoreColumn($event)" (onRemove)="onKeywordsRemoved($event)"
                                          theme='bootstrap'>
                                          <tag-input-dropdown [autocompleteItems]="keywordsAsObjects"
                                             [identifyBy]="'ID'" [displayBy]="'Name'">
                                          </tag-input-dropdown>
                                       </tag-input>
                                       <div
                                          *ngIf="lessonForm.controls['_Keywords'].invalid && (lessonForm.controls['_Keywords'].dirty || lessonForm.controls['_Keywords'].touched)"
                                          class="custom-errMsg">
                                          <div *ngIf="lessonForm.controls['_Keywords'].errors.required">
                                             Please press "enter" key to capture new Keywords
                                          </div>
                                       </div>
                                    </div>
                                 </div>
                              </div>
                           </div>
                           <div class="form-actions col-sm-12 text-right">
                              <button class="btn btn-secondary borderbtn" type="button"
                                 (click)="tabChange(1);remove();"><i class="fa fa-angle-double-left"></i> Back</button>
                              <button class="btn btn-primary borderbtn" type="button" (click)="tabChange(3);remove();"
                                 [disabled]="( lessonForm.controls['_Keywords'].invalid || !formControls.title.value || !formControls.typeoflesson.value || !formControls.issuedescription.value || !formControls.Recommendation.value || !formControls.rootcause.value )">Next
                                 <i class="fa fa-angle-double-right"> </i></button>

                           </div>
                        </div>
                        <div *ngIf="showPractice">
                           <div class="row">
                              <div class="col-sm-6">
                                 <div class="form-group row">
                                    <label class="col-md-3 col-form-label" for="textarea-input">Description <span
                                          class="danger">*</span></label>
                                    <div class="col-md-9">
                                       <textarea class="form-control" (blur)="lessonFormFields()" id="textarea-input"
                                          [(ngModel)]="issuedescription"
                                          [ngClass]="{'has-error is-invalid': isSubmitted && formControls.issuedescription.errors }"
                                          formControlName="issuedescription" placeholder="Description..." rows="6"
                                          maxlength="250" #description></textarea>
                                       <label
                                          class="float-left remaning">{{description.value.length}}/{{maxChars}}</label>


                                       <div
                                          *ngIf="lessonForm.controls['issuedescription'].invalid && (lessonForm.controls['issuedescription'].dirty || lessonForm.controls['issuedescription'].touched)"
                                          class="custom-errMsg">
                                          <div *ngIf="lessonForm.controls['issuedescription'].errors.required">
                                             Description is required.
                                          </div>

                                          <div *ngIf="lessonForm.controls['issuedescription'].errors.maxlength">
                                             Maximum character is 250 !!!
                                          </div>
                                       </div>
                                    </div>
                                 </div>
                              </div>
                              <div class="col-sm-6">
                                 <div class="form-group row">
                                    <label class="col-md-3 col-form-label" for="textarea-input">Recommendation <span
                                          class="danger">*</span></label>
                                    <div class="col-md-9">
                                       <textarea class="form-control" (blur)="lessonFormFields()" id="textarea-input"
                                          [(ngModel)]="Recommendation"
                                          [ngClass]="{'has-error is-invalid': isSubmitted && formControls.Recommendation.errors }"
                                          formControlName="Recommendation" placeholder="Recommendation..." rows="6"
                                          maxlength="250" #recommendation></textarea>
                                       <label
                                          class="float-left remaning">{{recommendation.value.length}}/{{maxChars}}</label>

                                       <div
                                          *ngIf="lessonForm.controls['Recommendation'].invalid && (lessonForm.controls['Recommendation'].dirty || lessonForm.controls['Recommendation'].touched)"
                                          class="custom-errMsg">
                                          <div *ngIf="lessonForm.controls['Recommendation'].errors.required">
                                             Recommendation is required.
                                          </div>
                                       </div>
                                    </div>
                                 </div>
                              </div>
                              <div class="col-sm-6">
                                 <div class="form-group row">
                                    <label class="col-md-3 col-form-label" for="text-input">Keywords<span
                                          class="danger">*</span></label>
                                    <div class="col-md-9">
                                       <tag-input [ngModel]="_Keywords.value" [theme]="'minimal'"
                                          [separatorKeyCodes]="[186,59]" formControlName="_Keywords"
                                          [placeholder]="'Select Keywords'" [secondaryPlaceholder]="'Select Keywords'"
                                          (onAdd)="addIgnoreColumn($event)" (onRemove)="onKeywordsRemoved($event)"
                                          theme='bootstrap'>
                                          <tag-input-dropdown [autocompleteItems]="keywordsAsObjects"
                                             [identifyBy]="'ID'" [displayBy]="'Name'">
                                          </tag-input-dropdown>
                                       </tag-input>
                                       <div
                                          *ngIf="lessonForm.controls['_Keywords'].invalid && (lessonForm.controls['_Keywords'].dirty || lessonForm.controls['_Keywords'].touched)"
                                          class="custom-errMsg">
                                          <div *ngIf="lessonForm.controls['_Keywords'].errors.required">
                                             Please press "enter" key to capture new Keywords
                                          </div>
                                       </div>
                                    </div>
                                 </div>
                              </div>
                           </div>
                           <div class="form-actions col-sm-12 text-right">
                              <button class="btn btn-secondary borderbtn" type="button"
                                 (click)="tabChange(1);remove();"><i class="fa fa-angle-double-left"></i> Back</button>
                              <button class="btn btn-primary borderbtn" type="button" (click)="tabChange(3);remove();"
                                 [disabled]="(lessonForm.controls['_Keywords'].invalid || !formControls.title.value ||  !formControls.typeoflesson.value || !formControls.issuedescription.value || !formControls.Recommendation.value )">Next
                                 <i class="fa fa-angle-double-right"> </i></button>
                           </div>
                        </div>

                     </tab>
                     <tab heading="Additional Information" [active]="additionalTab" [disabled]="additionaldTab">
                        <div class="row">
                           <div class="col-sm-6">
                              <div class="form-group row">
                                 <label class="col-md-3 col-form-label" foFbest r="text-input">Impact Category <span
                                       class="danger">*</span></label>
                                 <div class="col-md-9">
                                    <!-- <input class="form-control" id="text-input" name="impectcategory" placeholder="Impact category" type="text"> -->
                                    <select class="form-control"
                                       [ngClass]="{'has-error is-invalid': isSubmitted && formControls.impectcategory.errors }"
                                       [(ngModel)]="impectcategory" formControlName="impectcategory" id="icat">
                                       <option value="" selected>Select Impact Category</option>
                                       <option *ngFor="let category of categoriesAsObjects" value="{{category.ID}}">
                                          {{category.Name}}</option>
                                    </select>
                                    <div
                                       *ngIf="lessonForm.controls['impectcategory'].invalid && (lessonForm.controls['impectcategory'].dirty || lessonForm.controls['impectcategory'].touched)"
                                       class="custom-errMsg">
                                       <div *ngIf="lessonForm.controls['impectcategory'].errors.required">
                                          Impact Category is required.
                                       </div>
                                    </div>
                                 </div>
                              </div>
                           </div>
                           <div class="col-sm-6">
                              <div class="form-group row">
                                 <label class="col-md-3 col-form-label" for="text-input">Impact Level <span
                                       class="danger">*</span></label>
                                 <div class="col-md-9">
                                    <!-- <input class="form-control" id="text-input" name="impectlevel" placeholder="Impact level" type="text"> -->
                                    <select class="form-control"
                                       [ngClass]="{'has-error is-invalid': isSubmitted && formControls.impectlevel.errors }"
                                       [(ngModel)]="impectlevel" formControlName="impectlevel" id="implevel">
                                       <option value="" selected>Select Impact Level</option>
                                       <option *ngFor="let impectlevel of impactlevelAsObjects"
                                          value="{{impectlevel.ID}}">{{impectlevel.Name}}</option>
                                    </select>
                                    <div
                                       *ngIf="lessonForm.controls['impectlevel'].invalid && (lessonForm.controls['impectlevel'].dirty || lessonForm.controls['impectlevel'].touched)"
                                       class="custom-errMsg">
                                       <div *ngIf="lessonForm.controls['impectlevel'].errors.required">
                                          Impact Level is required.
                                       </div>
                                    </div>
                                 </div>
                                 <div class="help-tip">
                                    <table>
                                       <tr>
                                          <th style="text-align: center;">LOW</th>
                                          <th style="text-align: center;">Low â€“ Concise</th>
                                          <th style="text-align: center;">MODERATE</th>
                                          <th style="text-align: center;">Moderate - Concise</th>
                                          <th style="text-align: center;">HIGH</th>
                                          <th style="text-align: center;">High - Concise</th>
                                       </tr>
                                       <tr>
                                          <td>
                                             <ul>
                                                <li>
                                                   Quality Mgmt system or process is in place and was followed for
                                                   design control and post launched products.
                                                </li>
                                             </ul>
                                          </td>
                                          <td>
                                             <ul style="margin-bottom: -18%;">
                                                <li>
                                                   Low/no impact to final product performance and/or intended use.
                                                </li>
                                             </ul>
                                          </td>
                                          <td>
                                             <ul>
                                                <li>
                                                   Quality Mgmt system or process is in place, but are not being
                                                   followed for design control and post launched products.
                                                </li>
                                             </ul>
                                          </td>

                                          <td>
                                             <ul class="cssforsmall" style="margin-bottom: -5%;">
                                                <li>
                                                   Moderate impact to final product performance and/or intended use.
                                                </li>
                                             </ul>
                                          </td>


                                          <td>
                                             <ul>
                                                <li class="cssforsmallscreen" style="margin-bottom: 16%;">
                                                   Failure of Quality Mgmt system or process.
                                                </li>
                                             </ul>
                                          </td>
                                          <td>
                                             <ul class="highcssforsmall">
                                                <li>
                                                   High / Significant impact to final product performance and/or
                                                   intended use.
                                                </li>
                                             </ul>
                                          </td>
                                       </tr>
                                       <tr>
                                          <td>
                                             <ul>
                                                <li class="issueforsmall">
                                                   The issue has no effect on product design/improvements,product
                                                   performance,the established products/customer requirements or
                                                   intended use
                                                   of the finished product.
                                                </li>
                                             </ul>
                                          </td>
                                          <td>
                                             <ul>
                                                <li>
                                                   Documentation was considered compliant during review.
                                                </li>
                                             </ul>
                                          </td>
                                          <td>
                                             <ul>
                                                <li class="issueforsmall">
                                                   The issue has more than a negligible effect on product
                                                   design/improvements,product performance the established
                                                   product/customer
                                                   requirements or intended use of the finished product.
                                                </li>
                                             </ul>
                                          </td>

                                          <td>
                                             <ul>
                                                <li>
                                                   Documentation was found to have moderate insufficiencies that
                                                   required update.
                                                </li>
                                             </ul>
                                          </td>

                                          <td>
                                             <ul>
                                                <li class="significant">
                                                   The issue has significant effect on product
                                                   design/improvements,product
                                                   performance,the established product/customer requirements or intended
                                                   use
                                                   of th finished product.
                                                </li>
                                             </ul>
                                          </td>
                                          <td>
                                             <ul>
                                                <li>
                                                   Documentation was found to be critically insufficient and required
                                                   significant effort to bring into compliance.
                                                </li>
                                             </ul>
                                          </td>
                                       </tr>
                                       <tr>
                                          <td>
                                             <ul>
                                                <li class="product">
                                                   The issue has no effect on product design/improvements,product
                                                   performance,the established products/customer requirements or
                                                   intended use
                                                   of the finished product.
                                                </li>
                                             </ul>
                                          </td>
                                          <td>
                                          </td>
                                          <td>


                                             <ul>
                                                <li class="negli">
                                                   The issue has more than a negligible effect on product
                                                   design/improvements,product performance the established
                                                   product/customer
                                                   requirements or intended use of the finished product.
                                                </li>
                                             </ul>
                                          </td>
                                          <td>
                                          </td>
                                          <td>
                                             <ul>
                                                <li class="cssfromsmall">
                                                   The issue has significant effect on product
                                                   design/improvements,product
                                                   performance,the established product/customer requirements or intended
                                                   use
                                                   of th finished product.
                                                </li>
                                             </ul>
                                          </td>
                                          <td>
                                          </td>
                                       </tr>
                                       <tr>
                                          <td>
                                             <ul>
                                                <li>
                                                   Project activities and documentation are compliant.
                                                </li>
                                             </ul>
                                          </td>
                                          <td>
                                          </td>
                                          <td>
                                             <ul>
                                                <li class="cssfordoc">
                                                   Project activities and documentation are in place,but are not
                                                   compliant.
                                                </li>
                                             </ul>
                                          </td>
                                          <td>
                                          </td>
                                          <td>
                                             <ul>
                                                <li class="cssforproject">
                                                   Project activities and documentation are not in place.
                                                </li>
                                             </ul>
                                          </td>
                                          <td>
                                          </td>
                                       </tr>
                                       <tr>
                                          <td>
                                             <ul>
                                                <li class="relationforsmall">
                                                   Rational is provided for planned and unplanned project deviations.
                                                </li>
                                             </ul>
                                          </td>
                                          <td>
                                          </td>
                                          <td>
                                             <ul>
                                                <li class="relationforsmall">
                                                   Rational for planned and unplanned project deviations are provided
                                                   but considered insignificant for resultant outcome.
                                                </li>
                                             </ul>
                                          </td>
                                          <td>
                                          </td>
                                          <td>
                                             <ul>
                                                <li class="norelational">
                                                   No rational is provided for planned and unplanned project deviations.
                                                </li>
                                             </ul>
                                          </td>
                                          <td>
                                          </td>
                                       </tr>


                                    </table>
                                    <!-- <p>Please insert All Impact level</p> -->
                                 </div>
                              </div>
                           </div>
                           <div class="col-sm-6">
                              <div class="form-group row">
                                 <label class="col-md-3 col-form-label" for="file-input">Attachments</label>
                                 <div class="col-md-9">
                                    <input id="attachments" (change)="onFileChangeProject($event)"
                                       [ngClass]="{'has-error is-invalid': isSubmitted && formControls.attachments.errors }"
                                       class="form-control filellm" type="file">
                                    <div
                                       *ngIf="lessonForm.controls['attachments'].invalid && (lessonForm.controls['attachments'].dirty || lessonForm.controls['attachments'].touched)"
                                       class="custom-errMsg">
                                       <div *ngIf="lessonForm.controls['attachments'].errors.required">
                                          Document is required.
                                       </div>
                                    </div>
                                 </div>

                              </div>
                           </div>
                        </div>
                        <div class="form-actions col-sm-12 text-right">
                           <button class="btn btn-secondary borderbtn" type="button" (click)="tabChange(2)"> <i
                                 class="fa fa-angle-double-left"> </i>Back</button>
                           <button class="btn btn-primary borderbtn" type="submit"
                              [disabled]="(!formControls.impectcategory.value || !formControls.impectlevel.value)"><span
                                 class="spinner-border spinner-border-sm" role="status" aria-hidden="true"
                                 *ngIf="showLoader"></span>{{showLoader? 'Loading...' : 'Submit'}}</button>
                           <!--<button class="btn btn-danger" *ngIf = "isupdate" style = "border-radius: 4px;" (click)="deletelesson()" type="button" > Delete </button>-->
                           <!-- <button class="btn btn-danger"  *ngIf = "isupdate"  onclick="document.getElementById('id01').style.display='block'" style = "border-radius: 4px;">Delete</button> -->
                        </div>
                     </tab>
                  </tabset>
               </div>
            </form>

            <div bsModal id="id01" class="modal">
               <form class="modal-content" style="width: 30%; height: 22%; left: 36%;">
                  <div class="container">
                     <h3 style="text-align: center; margin-top:2%">Are you sure you want to delete this lesson?</h3>
                     <div class="clearfix">
                        <br>
                        <br>
                        <button type="button" (click)="deletelesson(URLlessonID)"
                           class="deletebtn btn btn-danger float-right borderbtn"> Delete <i
                              class="fa fa-trash"></i></button>
                        <button type="button borderbtn" onclick="document.getElementById('id01').style.display='none'"
                           class="cancelbtn btn btn-primary float-right">Cancel <i class="fa fa-close"></i></button>
                     </div>
                  </div>
               </form>
            </div>
         </div>
      </div>
   </div>
</div>
<div bsModal #myModal="bs-modal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
   aria-hidden="true">
   <div class="modal-dialog" role="document">
      <div class="modal-content">
         <div class="modal-body">
            <div class="textcenter"> <i class="cui-circle-check icons font-2xl d-block mt-4 Iconsuccess"></i>
            </div>
            <p style="font-size: 1rem;padding: 1rem;text-align: center">Your lesson was successfully recorded.</p>
         </div>
         <div class="modal-footer">
            <button type="button" class="btn btn-primary borderbtn" (click)="reloadaction()">Ok</button>
         </div>
      </div>
   </div>
</div>
<!-- <div class="w3-container"> 
   <div id="id01" class="w3-modal">
     <div class="w3-modal-content">
       <div class="w3-container">
         <span onclick="document.getElementById('id01').style.display='none'" class="w3-button w3-display-topright">&times;</span>
         <h1 style="text-align: center; margin-top:7%">Delete Lesson</h1>
         <p style="text-align: center;">Are you sure you want to delete this lesson?</p>
         <div class="clearfix">
            <button  type="button" (click)="deletelesson()" class="deletebtn btn btn-danger float-right" style = "border-radius: 4px; " > Delete</button>
            <button  type="button" onclick="document.getElementById('id01').style.display='none'" style = "border-radius: 4px;" class="cancelbtn btn btn-primary float-right">Cancel</button>
         </div>
       </div>
     </div>
   </div>
 </div> -->
<div bsModal #bulkimport="bs-modal" class="modal bulkimport">
   <form class="modal-content row bulkimport-form" (ngSubmit)="addBulk(fileInput)">
      <div class="container">
         <div class="form-group row">
            <label class="col-md-12 col-form-label" for="file-input">Attachment (excel only) </label>
            <div class="col-md-12">
               <!-- <input id="attachments" (change)="onFileChangeBulkProject($event)"
                     [ngClass]="{'has-error is-invalid': isSubmitted && formControls.attachments.errors }"  type="file"
                     accept="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"> -->
               <div class="custom-file mb-3">
                  <input #fileInput type="file" (change)="onFileChangeBulkProject($event)"
                     (click)="fileInput.value = null" class="custom-file-input"
                     accept="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet">
                  <p id=remove>Please Choose file</p>
                  <label class="custom-file-label" for="customFile">{{xlFileName ? xlFileName : 'Choose file'}}</label>
               </div>
            </div>
         </div>
         <button type="submit" class="deletebtn btn btn-danger float-right borderbtn"> Submit</button>
         <button type="button" (click)="closeBulkImportModule()"
            class="cancelbtn btn btn-primary float-right borderbtn">Cancel</button>
      </div>
   </form>
</div>